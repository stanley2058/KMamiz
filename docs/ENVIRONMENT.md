# Environment

| Name                          | Default                                                   | Accept                                                                   | Description                                                                                                                                                                                                                                                                                                          |
| ----------------------------- | --------------------------------------------------------- | ------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `TZ`                          | `Asia/Taipei`                                             | [Timezone](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones) | Docker Timezone                                                                                                                                                                                                                                                                                                      |
| `PORT`                        | `3000`                                                    | Any free port                                                            | Port KMamiz runs on (in container).                                                                                                                                                                                                                                                                                  |
| `API_VERSION`                 | `1`                                                       | Any url escaped string                                                   | This is used in the API prefix (`/api/v1/...`).                                                                                                                                                                                                                                                                      |
| `LOG_LEVEL`                   | `info`                                                    | `verbose`, `info`, `warn`, `error`                                       | KMamiz's log level.                                                                                                                                                                                                                                                                                                  |
| `KUBEAPI_HOST`                | `http://127.0.0.1:8080`                                   | URI                                                                      | This should be set by Kubernetes.                                                                                                                                                                                                                                                                                    |
| `IS_RUNNING_IN_K8S`           | `undefined`                                               | `true`, `false`, `undefined`                                             | If this variable is true, KMamiz will switch to Kubernetes operation mode and tries to retrieve Kubernetes API auth token.                                                                                                                                                                                           |
| `ZIPKIN_URL`                  | `http://localhost:9411`                                   | URI                                                                      | The Zipkin URL, the default for Istio is `http://zipkin.istio-system:9411`.                                                                                                                                                                                                                                          |
| `MONGODB_URI`                 | `mongodb://admin:admin@localhost:27017/?authSource=admin` | URI                                                                      | The MongoDB URL.                                                                                                                                                                                                                                                                                                     |
| `AGGREGATE_INTERVAL`          | `*/5 * * * *`                                             | Cron expression                                                          | Interval described in Cron expression (default is: 5m).                                                                                                                                                                                                                                                              |
| `REALTIME_INTERVAL`           | `0/5 * * * *`                                             | Cron expression                                                          | Interval described in Cron expression (default is: 5s).                                                                                                                                                                                                                                                              |
| `DISPATCH_INTERVAL`           | `0/30 * * * *`                                            | Cron expression                                                          | Interval described in Cron expression (default is: 30s).                                                                                                                                                                                                                                                             |
| `ENVOY_LOG_LEVEL`             | `info`                                                    | `info`, `warning`, `error`                                               | The Envoy logging level which KMamiz should look for. For the current WASM deployment, this value should be set to `warning` as in the deployment sample config.                                                                                                                                                     |
| `RESET_ENDPOINT_DEPENDENCIES` | `undefined`                                               | `true`, `false`, `undefined`                                             | If this variable is set to `true`, KMamiz will clear the current endpoint dependency and recreate one.                                                                                                                                                                                                               |
| `READ_ONLY_MODE`              | `undefined`                                               | `true`, `false`, `undefined`                                             | If this variable is set to `true`, KMamiz will start in readonly mode. In this mode, no schedule will be setup, meaning the only requirement for KMamiz to run is a MongoDB. (System Under Monitoring, Zipkin, Istio, even Kubernetes are not required. KMamiz will run happily with only a MongoDB under this mode) |
| `ENABLE_TESTING_ENDPOINTS`    | `undefined`                                               | `true`, `false`, `undefined`                                             | If this variable is set to `true`, KMamiz will expose testing endpoints, see [API](./API.md) for more detail.                                                                                                                                                                                                        |
| `SERVICE_PORT`                | `undefined` \|\| `PORT` \|\| `3000`                       | Any free port                                                            | This port must match the Kubernetes service port, and is used to force data sync before starting a new instance.                                                                                                                                                                                                     |
| `SERVE_ONLY`                  | `undefined`                                               | `true`, `false`, `undefined`                                             | If this variable is set to `true`, KMamiz will only expose static files and no schedule will be setup. This is intended for development testing where the KMamiz's WASM EnvoyFilter is needed in the Kubernetes cluster.                                                                                             |
